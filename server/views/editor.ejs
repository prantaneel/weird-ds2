<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="http://fonts.cdnfonts.com/css/helvetica-neue-9?styles=49034,49031,49035,49032,49045,49046"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles/style.css" />
    <link rel="stylesheet" href="./styles/content.css" />
    <link rel="stylesheet" href="./styles/extra.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdn.tiny.cloud/1/dt5omy0vy0rxheqkc7tg2kgvugt393i96jsevx9sl6hc2ksp/tinymce/5/tinymce.min.js"
      referrerpolicy="origin"
    ></script>
    <link href="./prism/prism.css" rel="stylesheet" />
    <link rel="stylesheet" href="/styles/_global.css" />
    <script>
      var editorWindowRef;
      let liveData = {
        blog_title: "",
        blog_html: "",
      };
      tinymce.init({
        selector: "#mytextarea",
        width: "70%",
        height: 500,
        onchange_callback: "tinymceOnchange",
        setup: function (editor) {
          editor.on("keyup", function (e) {
            liveData.blog_title = document.getElementById("input_field").value;
            liveData.blog_html = tinymce.get("mytextarea").getContent();
            if (editorWindowRef) {
              var time = new Date();
              var date = time.toLocaleDateString();
              time = time.toLocaleTimeString();
              editorWindowRef.document.getElementById(
                "blog-title"
              ).textContent = liveData.blog_title;
              editorWindowRef.document.getElementById(
                "blog-time"
              ).textContent = `Updated on ${date}, ${time}`;
              editorWindowRef.document.getElementById("blog-body").innerHTML =
                liveData.blog_html;
            }
          });
        },
        codesample_languages: [
          { text: "HTML/XML", value: "markup" },
          { text: "JavaScript", value: "javascript" },
          { text: "CSS", value: "css" },
          { text: "PHP", value: "php" },
          { text: "Ruby", value: "ruby" },
          { text: "Python", value: "python" },
          { text: "Java", value: "java" },
          { text: "C", value: "c" },
          { text: "C#", value: "csharp" },
          { text: "C++", value: "cpp" },
        ],
        plugins: [
          "advlist autolink link image lists charmap print preview hr anchor pagebreak",
          "searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking",
          "table emoticons template paste help",
          "image tiny_mce_wiris",
          "codesample",
        ],
        toolbar:
          "undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | " +
          "bullist numlist outdent indent | link image | print media fullscreen | " +
          "forecolor backcolor emoticons | help |" +
          "tiny_mce_wiris_formulaEditor | codesample",
        menu: {
          favs: {
            title: "My Favorites",
            items: "code visualaid | searchreplace | emoticons",
          },
        },
        external_plugins: {
          tiny_mce_wiris:
            "https://www.wiris.net/demo/plugins/tiny_mce/plugin.js",
        },
        menubar: "favs file edit view insert format tools table help",
        content_css: "/styles/content.css",
        codesample_content_css: "prism/prism.css",
        codesample_global_prismjs: true,
        theme_advanced_toolbar_location: "top",
        body_class: "body_class",
      });
    </script>
    <title>Editor</title>
  </head>

  <body>
    <div class="topnav">
      <a class="active" href="/">Home</a>
      <a href="#">About</a>
      <a href="/blog-editor">Create</a>
      <a href="/blogs">Blogs</a>
    </div>

    <div class="editor-body">
      <div class="title-div">
        <h2 id="title_text">Title</h2>
        <label class="input">
          <input
            class="input__field"
            type="text"
            placeholder=" "
            id="input_field"
            onchange="titleChange()"
          />
          <span class="input__label">a catchy title</span>
        </label>
      </div>
      <textarea id="mytextarea"></textarea>
      <div class="live-editor" id="live-editor">
        [<a href="#">Live Editor</a>]
      </div>
      <button id="btn" class="bubbly-button">Add</button>
    </div>

    <div id="blog" class="blog-body" style="display: none"></div>
    <div id="snackbar">Submitted for review.</div>
    <script src="./prism/prism.js"></script>
  </body>
  <script>
    function titleChange() {
      var title_name = document.getElementById("input_field").value;
      if (title_name === "" || title_name == undefined) {
        title_name = "Title";
      }
      document.getElementById("title_text").innerText = title_name;
      document.title = title_name;
    }
  </script>
  <script src="/scripts/live-editor.js"></script>
  <script src="/scripts/actions.js"></script>
</html>
